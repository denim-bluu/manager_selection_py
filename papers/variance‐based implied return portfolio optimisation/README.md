# Portfolio Optimisation via Implied Returns

## 1. Introduction

Here, we are going to talk about the portfolio optimisation methodology based on the concept of "implied return". The idea is to adjust the portfolio weights so that the estimated expected return is matched by the return implied by each strategy's risk contribution.

## 2. Expected Return Computation

### 2.1 Building‐Block Model

Each hedge strategy’s expected return, $r_{\text{exp},i}$, is estimated as the sum of three components:

- **Cash:** A base yield (e.g. a risk‐free rate or an inflation‐adjusted return)
- **Beta:** The return attributable to the strategy’s market exposure
- **Alpha:** The active return generated by the strategy’s management

Thus, for strategy $i$:

$$
r_{\text{exp},i} = r_{\text{cash}} + \beta_i \times (\text{Market Return}) + \alpha_i.
$$

The portfolio’s overall expected return, $r_{\text{exp}}$, is then the weighted average of the individual $r_{\text{exp},i}$.

## 3. Implied Return

### 3.1 Overview

The implied return of a strategy is the return “required” by its marginal contribution to the portfolio’s risk. The notion is that the portfolio is optimal when, for every strategy $i$,

$$
r_{\text{exp},i} \approx r_{\text{imp},i},
$$

with any discrepancy suggesting that the strategy’s allocation should be adjusted.

### 3.2 Portfolio Variance as the Risk Measure

The portfolio variance is:

$$
V_p = \sigma_p^2 = \mathbf{w}^T \Sigma \mathbf{w}.
$$

Where

- $\mathbf{w} = [w_1, w_2, \dots, w_n]^T$
- $\Sigma$ is the covariance matrix of returns.

#### 3.2.1 Marginal Contribution to Variance

If we use variance as the measure of risk, the sensitivity of the portfolio variance to a change in the weight of strategy $i$ is given by:

$$
\frac{\partial V_p}{\partial w_i} = 2\,(\Sigma \mathbf{w})_i.
$$

This term represents the marginal risk contribution of strategy $i$ in terms of variance.

#### 3.2.2 Defining the Implied Return

We now convert the marginal contribution to variance into an implied return by introducing a scaling parameter, denoted here by $\lambda$. The implied return for strategy $i$ is defined as:

$$
r_{\text{imp},i} = \lambda \cdot \frac{\partial V_p}{\partial w_i} = 2\lambda\, (\Sigma \mathbf{w})_i.
$$

#### 3.2.3 Derivation of the Risk Aversion Parameter $\lambda$

To calibrate $\lambda$, we require that the portfolio’s overall expected return equals the weighted average of the individual implied returns. That is, we set

$$
r_{\text{exp}} = \sum_{i=1}^n w_i\, r_{\text{imp},i} = 2\lambda \sum_{i=1}^n w_i\, (\Sigma \mathbf{w})_i.
$$

Noting that

$$
\sum_{i=1}^n w_i\, (\Sigma \mathbf{w})_i = \mathbf{w}^T \Sigma \mathbf{w} = V_p,
$$

the equation becomes

$$
r_{\text{exp}} = 2\lambda\, V_p.
$$

Solving for $\lambda$ gives:

$$
\lambda = \frac{r_{\text{exp}}}{2\,V_p}.
$$

Thus, the risk aversion parameter $\lambda$ is derived as the portfolio’s expected return divided by twice the portfolio variance.

## 4. Optimisation Framework

### 4.1 Optimality Condition

For an optimal portfolio, the individual discrepancies between the expected and implied returns should be minimised. Formally, the optimisation problem seeks to minimise:

$$
\text{Obj} = \sum_{i=1}^n \left( r_{\text{exp},i} - \frac{r_{\text{exp}}}{V_p}\, (\Sigma \mathbf{w})_i \right)^2,
$$

subject to constraints such as:

- **Budget Constraint:** $\sum_{i=1}^n w_i = 1$.
- **Weight Bounds:** $w_i^{\text{min}} \leq w_i \leq w_i^{\text{max}}$ for each strategy.
- **Additional Strategy Constraints:** As required by the investor’s guidelines.

This framework is grounded in fundamental economic principles of marginal analysis. In economics, optimal resource allocation is achieved when the marginal benefit equals the marginal cost. In this portfolio optimisation context:

- **Marginal Return (Benefit):**  
  Each strategy’s expected return, $r_{\text{exp},i}$, represents the marginal benefit—the incremental return that the strategy is anticipated to provide.

- **Marginal Risk (Cost):**  
  The marginal risk contribution, $2\,(\Sigma \mathbf{w})_i$, reflects the additional risk (or cost) incurred by increasing the allocation to that strategy. By scaling this contribution with the risk aversion parameter, we express the risk cost in return terms.

The optimisation seeks to equate the marginal benefit with the marginal cost for each strategy. If a strategy’s expected return exceeds its risk-implied return, it indicates that the incremental benefit of investing in that strategy outweighs the additional risk—suggesting that its allocation should be increased. Conversely, if the expected return is below the risk-implied return, the allocation should be reduced.

This approach not only ensures that every unit of risk taken is adequately compensated by the corresponding expected return, but it also provides a systematic method for dynamically adjusting portfolio weights in response to changing market conditions. In other words, by aligning marginal return with marginal cost, the portfolio remains efficient, well-diversified, and optimally positioned to achieve its risk-return objectives.

## Example Code Output

```text
Expected returns: ['0.080', '0.040', '0.070']
Initial weights: ['0.600', '0.250', '0.150']
Initial variance: 0.0142
Initial expected portfolio return: 0.0685
Initial Implied returns: ['0.103', '0.006', '0.034']

Optimal weights: ['0.577', '0.000', '0.423']
Updated Implied returns: ['0.103', '0.004', '0.038']
Optimised variance: 0.0168
Optimised expected portfolio return: 0.0758
```
